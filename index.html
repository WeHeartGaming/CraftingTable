<html>
<head>
	<title>The Crafting Table</title>
	<link href="/style.css" media="all" rel="stylesheet" type="text/css" />
	<script src="/jquery.js"></script>
</head>
<body>
	<div id="items">
		<div id="search"><input type="text" placeholder="Search..." value="" /></div>
		<div id="itemtype"><a href="#" id="0">All</a><a href="#" id="1">Crafted</a><a href="#" id="2">Cooked</a></div>
		<div id="itemlist"><ul></ul></div>
	</div>
	<div id="left">
		<header><h1>WeHeartGaming | Minecraft Item list and Crafting guide</h1></header>
		<div id="craftingtable" class="table">
			<h1>Crafting Table</h1>
			<div id="bench">
				<div id="b0"><img src="/images_minecraft/0.png" alt="air" /></div>
				<div id="b1"><img src="/images_minecraft/0.png" alt="air" /></div>
				<div id="b2"><img src="/images_minecraft/0.png" alt="air" /></div>
				<div id="b3"><img src="/images_minecraft/0.png" alt="air" /></div>
				<div id="b4"><img src="/images_minecraft/0.png" alt="air" /></div>
				<div id="b5"><img src="/images_minecraft/0.png" alt="air" /></div>
				<div id="b6"><img src="/images_minecraft/0.png" alt="air" /></div>
				<div id="b7"><img src="/images_minecraft/0.png" alt="air" /></div>
				<div id="b8"><img src="/images_minecraft/0.png" alt="air" /></div>
			</div>
			<div id="crafted"><img src="/images_minecraft/0.png" alt="air" /></div>
			<div class="clear"></div>
		</div>
		<div id="furnace" class="table">
			<h1>Furnace</h1>
			<div id="uncooked"><img src="/images_minecraft/0.png" alt="air" /></div>
			<div id="cooked"><img src="/images_minecraft/0.png" alt="air" /></div>
			<div class="clear"></div>
		</div>
		<footer>Created by <a href="http://weheartgaming.com">WeHeartGaming</a> &copy; 2013</footer>
	</div>
	<script type="text/javascript">
		var allItems = {};
		var allRecipes = {};

		var currentRecipe = {};

		var interval = null;
		var rotation = 0;

		var itemtype = "0";

		var search = "";
		var regular = new RegExp("", "i");

		function drawItemList()
		{
			for(i in allItems)
			{
				if(regular.test(allItems[i][1]))
				{
					var type = null;

					if(allItems[i][2] == "1")
					{
						type = "crafted";
					}
					else if(allItems[i][2] == "2")
					{
						type = "cooked";
					}
					else
					{
						type = "na";
					}

					if(itemtype == allItems[i][2])
					{
						$("#itemlist ul").append('<li class="'+type+'" class="crafted" id="'+allItems[i][0]+'"><img src="/images_minecraft/'+allItems[i][0]+'.png" alt="'+allItems[i][1]+'" />'+allItems[i][1]+' <span>(id: '+allItems[i][0]+')</span></li>');
					}
					else if(itemtype == "0")
					{
						$("#itemlist ul").append('<li class="'+type+'" id="'+allItems[i][0]+'"><img src="/images_minecraft/'+allItems[i][0]+'.png" alt="'+allItems[i][1]+'" />'+allItems[i][1]+' <span>(id: '+allItems[i][0]+')</span></li>');
					}
				}
			}
		}

		$(document).ready(function(){
			$.get("/minecraft_items.json", function(data)
			{
				allItems = data;
				drawItemList();
			}, "json");

			$.get("/minecraft_recipes.json", function(data)
			{
				allRecipes = data;
			}, "json");

			var listheight = $(window).height() - 81;
			$("#itemlist").css("height", listheight);

		});
		function switchRecipes()
		{

			for(var i = 0; i <= 8; i++)
			{
				if(currentRecipe[rotation][i] != 0)
				{
					$("#bench #b"+i+" img").attr('src', '/images_minecraft/'+currentRecipe[rotation][i]+'.png').attr('id', currentRecipe[rotation][i]).attr("alt", currentRecipe[rotation][i]);
				} else {
					$("#bench #b"+i+" img").attr('src', '/images_minecraft/0.png').attr('id', "0").attr("alt", "air");
				}
			}
			if(currentRecipe.length -1 <= rotation)
			{
				rotation = 0;
			}
			else
			{
				rotation = rotation + 1;
			}
		}
		$("#search input").on("keyup", function(e){
			e.preventDefault;
			search = $(this).val();
			regular = new RegExp(search, "i");
			$("#itemlist ul").empty();

			drawItemList();
		});
		$("#itemtype a").on("click", function(e){
			e.preventDefault();

			itemtype = $(this).attr("id");
			$("#itemtype a").css("font-weight", "normal");
			$(this).css("font-weight", "bold");

			$("#itemlist ul").empty();

			drawItemList();
		});

		function clearTable()
		{
			$("#bench div img").attr("src", '/images_minecraft/0.png').attr("id", "0").attr("alt", "air");
			$("#craftingtable #crafted img").attr("src", '/images_minecraft/0.png').attr("id", "0").attr("alt", "air");
			$("#furnace #uncooked img").attr("src", '/images_minecraft/0.png').attr("id", "0").attr("alt", "air");
			$("#furnace #cooked img").attr("src", '/images_minecraft/0.png').attr("id", "0").attr("alt", "air");
		}

		function clickBench()
		{
			var item = $(this);
			var IID = item.attr("id");
			if(IID == "0")
			{
				return;
			}

			clearTable();

			$("#craftingtable #crafted img").attr("src", '/images_minecraft/'+IID+'.png').attr("id", IID);

			currentRecipe = allRecipes[IID];

			rotation = 0;
			switchRecipes();
			clearInterval(interval);
			
			if(currentRecipe.length > 1)
			{
				clearInterval(interval);
				interval = setInterval(switchRecipes, 2000);
			}
			else
			{
				switchRecipes();
			}
		}

		function clickFurnace()
		{
			var item = $(this);
			var IID = item.attr("id");

			clearTable();
			
			$("#furnace #cooked img").attr("src", '/images_minecraft/'+IID+'.png').attr("alt", allItems["263-1"][1]);

			$("#furnace #uncooked img").attr("src", '/images_minecraft/'+allRecipes[IID][0][0]+'.png').attr("alt", allItems[IID][1]);
		}

		$("#items #itemlist ul").on("click", "li.crafted", clickBench);
		$("#bench div").on("click", "img", clickBench);
		$("#items #itemlist ul").on("click", "li.cooked", clickFurnace);

		$(window).on("resize", function(){
			$("#itemlist").css("height", "0px");
			var listheight = $(window).height() - 81;
			$("#itemlist").css("height", listheight+"px");
		});
	</script>
</body>
</html>